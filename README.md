# Задание 1.
### Управление уязвимостями.

Думаю, что нет смысла говорить, что такое уязвимость, поэтому сразу к делу.

Управление уязвимостями - это циклический процесс, направленный на обнаружение и классификацию уязвимостей, а также на их устанение или снижение последствий их эксплуатации.

Если пошагово рассмотреть структуру процесса управления уязвимостями, то получается что-то похожее на круговую поруку

![](1.png)

  **1.**  	**Инвентаризация.** Как правило, начинается все с Инвентаризации. Смысл в том, чтобы выявить все устройства в сети, разбить их на однотипные группы (уровень детализации такого разбиения может варьироваться в зависимости от масштабов сети клиента или наличия большого числа специфических устройств), выбрать группы, в отношении которых оказывается услуга, узнать лиц, ответственных за выбранные группы.

   Важно не просто разово провести эту процедуру, а выделить паттерны, чтобы в любое время понимать, что происходит в сети, находить новые устройства, находить старые устройства, которые переехали, находить новые подтипы внутри групп и прочее.

  **2.**  	**Сканирование** начинается с планирования. После получения всей необходимой информации о изучаемой сети составляется план-график сканирования на уязвимости. Периодичность сканирования может быть любой. Внешний периметр рекомендуется проверять значительно чаще, чтобы минимизировать риск эксплуаатции 1-day(только что опубликованных) уязвимостей. Та же рекомендация касается и публичных Web-ресурсов клиента.

Важно использовать несколько разных сканеров, а также брать во внимание уязвимости, которые не определяются стандартными инструментами. Необходимо перед сканированием убедиться, что сканеры умеют находить все публичные уязвимости, в противном случае, если стандартного инструментария не хватает, нужно проводить поиск отдельных уязвимостей вручную.
  
  **3.** **Анализ результатов сканирования.** Наверное, самое сложное - это из километрового списка однотипных записей найти то, что нужно оставить, а что нужно исправить, и в каком порядке действовать. 
| Параметры оценивания результатов |
| ------------- |
| Доступность уязвимого устройства/сервиса для потенциального нарушителя |
| Наличие публичного эксплойта |
| Сложность эксплуатации |
| Потенциальный риск для бизнеса |
| Не является ли ложным срабатыванием |
| Сложность устранения |
| Прочее... |

  **4.** В **Запрос на устранение уязвимостей** после обработки результатов попадают "проверенные и одобренные" уязвимости. Проводятся консультации с ответственными за уязвимые устройства, рассказывается что найдено, чем это грозит и какие варианты минимазации рисков есть.

  **5.** **Устранение уязвимостей.** На этом этапе команда разработки занимается устранением найденной уязвимости. Бывает, когда уязвимость устранить не получается (на это есть целый ряд причин), в этом случае применяются творческие меры усложняющие эксплуаатцию уязвимости.

  **6.** **Контроль устранения уязвимостей.** Также существует человеческий фактор, который позволяет игнорировать устранение уязвимостей. Чтобы контролировать это и проверять качество проделанной работы проводят контроль устранения уязвимостей. Если уязвимость закрыта, запускается проверка, чтобы убедиться, что уязвимости больше нет. Т.к. проверка запускается на одну уязвимость, она занимает немного времени. Если уязвимость закрыта - это подтвреждается, иначе отправляется на доработку.

> Материал взят из [Процесс управления уязвимостями](https://www.ptsecurity.com/upload/corporate/ru-ru/webinars/ics/webinar_06mar.pdfz), [Управление уязвимостями: стандарты, реальность, инструменты](https://www.youtube.com/watch?v=h7nccGt9KE0&list=PLqVZIPeC5H0nN3w-EVxlzjH6mRuCUvFjW), [Как мы управление уязвимостями построили](https://habr.com/ru/company/acribia/blog/460048/)

### Какие бывают уязвимости и где встречаются?

Существует действительно много вариантов классификации уязвимостей. Например, классификация уязвимостей по степени риска, классификация уязвимостей по типу эксплуатации, классификации по уровню информационной структуры организации.

Я решил остановиться на варианте классификации по области происхождения.

| Уязвимости информационных систем. |
| ----------- |
| Уязвимости кода |
| Уязвимости конфигурации |
| Уязвимости архитектуры |
| Организационные уязвимости |
| Многофакторные уязвимости |

Уязвимости информационных систем по месту возникновения подразделяют на следующие:

#### Уязвимости ИС по месту возникновения
  **1. Уязвимости в общесистемном ПО.** К таким уязвимостям относятся уязвимости операционных систем, уязвимости систем управления базами данных, уязвимсоти специального инструментария, уязвимости общего програмного обеспечения.
  
  **2. Уязвимости в прикладном ПО.** Уязвимости офисных пакетов и иных типов прикладного ПО.
  
  **3. Уязвимости в специальном ПО.** Уязвимости микропрограмм в постоянных запоминающих устройствах, уязвимсоти базовой системы ввода-вывода, уязвимости ПО контроллеров управления.
  
  **4. Уязвимости в портативных технических средствах.** Уязвимости операционных систем мобильных устройств, уязвимости приложений для получения с мобильного устройства доступа в интернет.
  
  **5. Уязвимости в сетевом оборудовании.** Уязвимости маршрутизаторов, коммутаторов, уязвимости протоколов.
  
  **6. Уязвимости в средствах защиты информации.** Уязвимости в средствах управления доступом, средствах идентификации и аутентификации, средствах контроля целостности, средствах межсетевого экранирования.

> Также, разговаривая о уязвимостях, просто нельзя не упомянуть про [Топ 10 уязвимостей в веб приложениях](https://owasp.org/www-project-top-ten/)

> Материал взят из [ГОСТ Р 56546-2015 Защита информации. Уязвимости информационных систем. Классификация уязвимостей информационных систем](http://docs.cntd.ru/document/1200123702), [Угрозы, уязвимости и атаки в сетях](http://asher.ru/security/book/its/24), [Vulnerability (computing)
](https://en.wikipedia.org/wiki/Vulnerability_(computing))

### Опенсорсные инструменты для обнаружения уязвимостей.

Пробежимся по интсрументам.

  **1. OpenVas.** В основе работы OpenVAS-а лежит постоянно пополняемая коллекция NVT тестов безопасности (которых уже больше 30000), а также подключение к базе CVE, описывающей известные уязвимости. Исполнение NVT тестов позволяет выявить уязвимость, а CVE обеспечивает описание проблемы и способы её решения.

  Использование этого сканера не выглядит сложным и запутанным. Запускаем его, переходим по адресу localhost:9392, вводим логин и пароль, попадаем в консоль управления. Устанавливаем цели сканирования, выбираем конфигурацию сканирования и запускаем!
  
  Результат сканирования выглядит так: ![](2.png)

  **2. Nessus** - сканер для автоматизации проверки и обнаружения известных уязвимостей в системе. Исходный код закрыт, существует бесплатная версия Nessus Home, которая позволяет сканировать до 16 IP-адресов с такой же скоростью и подробным анализом, что и в платной версии.

Способен определять уязвимые версии служб или серверов, обнаруживать ошибки в конфигурации системы, выполнять bruteforce словарных паролей. Можно использовать для определения корректности настроек сервисов (почта, обновления и т.п.), а также при подготовке к PCI DSS аудиту. Кроме того в Nessus можно передать учетные данные для хоста (SSH или доменная учетная записи в Active Directory), и сканер получит доступ к хосту и проведет проверки прямо на нем. Удобен для компаний, проводящих аудиты собственных сетей.

  **3. Nexpose Community Edition** – инструмент поиска уязвимостей от компании, которая выпустила Metasploit. Версия Comunity полностью свободна, но она имеет ограничение, на одновременное сканирование до 32 IP адресов и только одного пользователя. Здесь нет сканирования веб-приложений, но зато поддерживается автоматическое обновление базы уязвимостей и получение информации об уязвимостях от Microsoft Patch.

  **4. Burp Suite** – как швейцарский армейский нож для тестирования веб-приложений. Burp Suite в своем огромном функционале имеет и сканеры. Его автоматический сканер уязвимостей основан на OWASP TOP 10 и других популярных ресурсах. 
  
  Результат сканирования выглядит так: ![](3.png)

  **5. OWASP Zed Attack Proxy (ZAP)** это  комплексный инструмент для поиска уязвимостей в веб-приложениях. Поддерживаются все, стандартные для такого типа программ возможности. Вы можете сканировать порты, проверять структуру сайта, искать множество известных уязвимостей, проверять корректность обработки повторных запросов или некорректных данных.

  Программа может работать по https, а также поддерживает различные прокси. Поскольку программа написана на Java, ее очень просто установить и использовать. Кроме основных возможностей, есть большое количество плагинов, позволяющих очень сильно увеличить функциональность.
  
  **6. Metasploit** – это интсрумент для создания, тестрирования и использования эксплоитов, имеющий широкий ряд инструментов для проведения сканирования. Имеет следующие сканеры: SMB Login Check, VNC-сканер, Веб-сканер WMAP, сканер хостов, сканер для повышения привилегий, поиск эксполитов

  **7. Nmap** – это не совсем сканер уязвимостей. Эта программа позволяет просканировать сеть и узнать какие узлы к ней подключены, а также определить какие сервисы на них запущенны. 
  
  **8. Sqlmap** – сканер с открытым исходным кодом, являющийся инструментом для тестирования на проникновение, который позволяет автоматизировать процесс обнаружения и использования SQL инъекций.
  
  **9. X-Scan** – многопоточный сканер уязвимостей от X-FOCUS для Windows систем. Программа позволяет искать уязвимые компьютеры к определенным эксплоитам в заданном диапазоне IP адресов.

> Существует еще много различных опенсорсных сканеров, я привел лишь малую часть наиболее популяных и тех, с которыми мне довелось поработать.

# Задание 2.
## Топ 10 критических уязвимостей за последние 5 лет.

Это больше, наверное, творческое задание. Я долго думал как мне определить критичность уязвимости для составления топа, потому что существуют как масштабные уязвимости, например EternalBlue, так и менее масштабные, но также критические, потому что могут привести к компрометации инфраструктуры. Я пришел к варианту, что буду считать наиболее критическими уязвимостями те, которые чаще всего эксплуатировались за последние 5 лет. К моему счастью, периодически всплывает в интернете такая статистика.


|  №  | Топ 10 критических уязвимостей |
| --- | ------------------------------ |
|  1  | CVE-2017-11882 |
|  2  | CVE-2017-0199 |
|  3  | CVE-2017-5638 |
|  4  | CVE-2012-0158 |
|  5  | CVE-2019-0604 |
|  6  | CVE-2017-0143 |
|  7  | CVE-2018-4878 |
|  8  | CVE-2017-8759 |
|  9  | CVE-2015-1641 |
|  10 | CVE-2018-7600 |

![](01.png)

Уязвимые продукты: Microsoft Office 2007 SP3, 2010 SP2, 2013 SP1, 2016

Microsoft Office 2007 SP3, Microsoft Office 2010 SP2, Microsoft Office 2013 SP1 и Microsoft Office 2016 позволяют злоумышленнику запускать произвольный код в контексте текущего пользователя, если ему не удается правильно обработать объекты в памяти, иначе » Уязвимость Microsoft Office, приводящая к повреждению памяти ".

Связанная малварь: Loki, FormBook, Pony/FAREIT


> Используемые материалы: [Top 10 Most Exploited Vulnerabilities 2016–2019](https://us-cert.cisa.gov/ncas/alerts/aa20-133a), [FBI and DHS Share List of Top 10 Most Exploited Vulnerabilities](https://cybersecuritynews.com/10-most-exploited-vulnerabilities/),

![](02.png)

Уязвимые продукты: Microsoft Office 2007 SP3, 2010 SP2, 2013 SP1, 2016, Vista SP2, Server 2008 SP2, Windows 7 SP1, Windows 8.1

Microsoft Office 2007 SP3, 2010 SP2, 2013 SP1, 2016, Vista SP2, Server 2008 SP2, Windows 7 SP1, Windows 8.1 позволяют злоумышленникам удаленно выполнять произвольный код с помощью специально созданного документа. Уязвимость известна как "Уязвимость удаленного выполнения кода Microsoft Office / WordPad w / Windows API.".

Связанная малварь: FINSPY, LATENTBOT, Dridex

![](03.png)

Уязвимые продукты: Apache Struts 2 2.3.x до 2.3.32 и 2.5.x до 2.5.10.1

Анализатор Jakarta Multipart в Apache Struts 2.3.x до 2.3.32 и 2.5.x до 2.5.10.1 имеет некорректную обработку исключений и генерацию сообщений об ошибках во время попыток загрузки файла, что позволяет злоумышленникам удаленно выполнять произвольные команды с помощью специально созданных Content-Type, Content-Disposition, или Content-Length HTTP хэдеров, которые были использованы с заголовком Content-Type, содержащим строку #cmd=.

Связанная малварь: JexBoss

![](04.png)

Уязвимые продукты: Microsoft Office 2003 SP3, 2007 SP2 и SP3 и 2010 Gold и SP1; веб-компоненты Office 2003 SP3; SQL Server 2000 SP4, 2005 SP4 и 2008 SP2, SP3 и R2; BizTalk Server 2002 SP1; Commerce Server 2002 SP4, 2007 SP2 и 2009 Gold и R2; Visual FoxPro 8.0 SP1 и 9.0 SP2; Visual Basic 6.0

Уязвимость позволяет злоумышленникам удаленно выполнять произвольный код через специально созданный (a) веб-сайт, (b) документ Office или (c) .rtf файл, который вызывает поврежденное состояние системы.

Связанная малварь: Dridex

![](05.png)

Уязвимые продукты: Microsoft SharePoint

В Microsoft SharePoint существует уязвимость удаленного выполнения кода, когда программное обеспечение не может проверить исходную разметку пакета приложения.

Связанная малварь: China Chopper

![](06.png)

Уязвимые продукты: Microsoft Windows Vista SP2; Windows Server 2008 SP2 и R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold и R2; Windows RT 8.1; и Windows 10 Gold, 1511 и 1607; Windows Server 2016

Сервер SMBv1 в Microsoft Windows Vista SP2; Windows Server 2008 SP2 и R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold и R2; Windows RT 8.1; и Windows 10 Gold, 1511 и 1607; Windows Server 2016 позволяет удалённым злоумышленникам выполнять произвольный код с помощью специально созданных пакетов.

Связанная малварь: многократное использование EternalSynergy и EternalBlue

![](07.png)

Уязвимые продукты: Adobe Flash Player до 28.0.0.161

Уязвимость use-after-free была обнаружена в Adobe Flash Player до 28.0.0.161. Эта уязвимость возникает из-за болтающегося указателя в Primetime SDK, связанного с обработкой медиаплеером объектов прослушивателя. Успешная атака может привести к выполнению произвольного кода.

Связанная малварь: DOGCALL

![](08.png)

Уязвимые продукты: Microsoft .NET Framework 2.0, 3.5, 3.5.1, 4.5.2, 4.6, 4.6.1, 4.6.2 и 4.7

Microsoft .NET Framework 2.0, 3.5, 3.5.1, 4.5.2, 4.6, 4.6.1, 4.6.2 и 4.7 позволяют злоумышленнику удаленно выполнять код через вредоносный документ или приложение.

Связанная малварь: FINSPY, FinFisher, WingBird

![](09.png)

Уязвимые продукты: Microsoft Word 2007 SP3, Office 2010 SP2, Word 2010 SP2, Word 2013 SP1, Word 2013 RT SP1, Word for Mac 2011, Office Compatibility Pack SP3, Word Automation Services на SharePoint Server 2010 SP2 и 2013 SP1, Office Web Apps Server 2010 SP2 и 2013 SP1

Уязвимость позволяет злоумышленникам удаленно выполнять произвольный код с помощью специально созданного документа RTF.

Связанная малварь: Toshliph, UWarrior

![](10.png)

Уязвимые продукты: Drupal до 7.58, 8.x до 8.3.9, 8.4.x до 8.4.6 и 8.5.x до 8.5.1

Drupal до 7.58, 8.x до 8.3.9, 8.4.x до 8.4.6 и 8.5.x до 8.5.1 позволяют злоумышленникам удаленно выполнять произвольный код из-за проблемы, затрагивающей несколько подсистем с конфигурациями по умолчанию или с общими конфигурациями модулей.

Связанная малварь: Kitty

